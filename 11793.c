/*
 * 11793. Electoral Districts
 * TOPIC: backtracking
 * status: Accepted
 */
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define N 6
#define BIT(k) (1ULL<<(k))
#define MASK(k) (BIT(k)-1ULL)
#define L(u) ((u)&((~(u))+1ULL))
#define vc(x,y) (0<=(x)&&(x)<n&&0<=(y)&&(y)<n)
enum { A, B };
#define oo (1L<<29)
int c[2][N*N],n,which[BIT(20)],w, idx[] = {0,0,4,26,139,710};
unsigned int b[N];

int who( unsigned int u ) {
	assert( !(u&(u-1)) );
	if ( u >= BIT(20) )
		return 20+which[u>>20];
	return which[u];
}

unsigned int a[] = {
3,5,10,12,7,11,19,22,25,26,38,50,52,56,73,88,146,152,176,200,208,292,304,400,416,448,15,23,39,46,51,54,71,78,99,102,108,113,114,116,142,198,204,226,228,232,240,275,305,306,368,547,550,561,562,610,612,624,736,785,802,816,864,1094,1100,1122,1124,1136,1220,1224,1248,1570,1584,1604,1632,1728,1808,1824,1856,2188,2244,2248,2272,3140,3168,3208,3264,3616,3648,3712,3840,4369,4400,4880,4896,5888,8738,8752,8800,8976,8992,9760,9792,9984,11776,12560,12832,13056,13824,17476,17504,17600,17952,17984,18176,19520,19584,19968,25120,25344,25664,26112,27648,28928,29184,29696,34952,35008,35904,35968,36352,50240,50688,51328,52224,57856,58368,59392,61440,31,47,79,94,103,110,143,158,167,199,206,220,227,229,230,236,271,286,334,391,398,412,451,454,458,460,472,481,482,484,488,542,668,782,796,902,908,916,920,962,964,968,976,992,1063,1123,1126,1249,1250,1252,1504,2119,2126,2147,2150,2243,2246,2252,2273,2274,2276,2498,2500,2504,2528,3008,3107,3139,3142,3169,3170,3266,3268,3296,3520,4231,4238,4252,4291,4294,4300,4321,4322,4324,4486,4492,4504,4546,4548,4552,4576,4996,5000,5008,5056,5344,6211,6214,6241,6242,6278,6284,6338,6340,6368,6532,6536,6592,7040,7201,7234,7264,7300,7328,7360,7552,8462,8476,8582,8588,8600,8642,8644,8648,8672,8972,8984,9092,9096,9104,9152,10688,12422,12428,12482,12484,12512,12556,12568,12676,12680,12736,13064,13072,13184,14402,14432,14468,14528,14600,14656,14720,15104,15392,15424,15488,15616,16924,17164,17176,17284,17288,17296,17344,21376,24844,24856,24964,24968,25024,25112,25352,25360,25472,28804,28864,28936,29056,29200,29312,29440,30784,30848,30976,31232,31744,33827,33889,33890,34016,35873,35906,35936,36032,39968,40000,40064,48128,67651,67654,67681,67682,67778,67780,67808,68032,68641,68674,68704,68800,71746,71776,71812,71872,72064,72736,72768,72832,79936,80000,80128,80896,96256,99361,99424,100418,100448,100544,101408,101440,104512,104576,105472,112640,135302,135308,135362,135364,135392,135556,135560,135616,136064,137282,137312,137348,137408,137600,138272,138304,138368,143492,143552,143624,143744,144128,145472,145536,145664,146432,159872,160000,160256,161792,171008,198722,198752,198848,199712,199744,200836,200896,201088,202816,202880,203776,209024,209152,210944,225280,230432,231488,232448,233600,234496,235520,241664,270604,270616,270724,270728,270784,271112,271120,271232,274564,274624,274696,274816,275200,276544,276608,276736,277504,286984,287104,287248,287488,290944,291072,291328,292864,342016,397444,397504,397696,399424,399488,400384,401672,401792,402176,405632,405760,407552,418048,418304,421888,460864,461824,462976,464896,467200,468992,471040,483328,492544,493568,495616,499712,541208,541448,541456,541568,549128,549248,549392,549632,553088,553216,553472,555008,684032,794888,795008,795392,798848,798976,800768,803344,803584,811264,811520,815104,921728,923648,925952,929792,934400,937984,942080,985088,987136,991232,999424,1015808,1082401,1082464,1084448,1084480,1088512,1147936,1148992,1149952,1153024,1278976,1280000,1282048,1540096,2164802,2164832,2164928,2165792,2165824,2168896,2168960,2169856,2177024,2196512,2197568,2198528,2201600,2295872,2296832,2297984,2299904,2306048,2327552,2328576,2330624,2557952,2560000,2564096,2588672,3080192,3179552,3181568,3213376,3214336,3217408,3245056,3246080,3344384,3346432,3375104,3604480,4329604,4329664,4329856,4331584,4331648,4332544,4337792,4337920,4339712,4354048,4393024,4393984,4395136,4397056,4403200,4424704,4425728,4427776,4591744,4593664,4595968,4599808,4612096,4655104,4657152,4661248,4685824,5115904,5120000,5128192,5177344,5472256,6359104,6360064,6363136,6390784,6391808,6426752,6428672,6434816,6490112,6492160,6520832,6688768,6692864,6750208,7208960,7373824,7407616,7438336,7475200,7503872,7536640,7733248,8659208,8659328,8659712,8663168,8663296,8665088,8675584,8675840,8679424,8786048,8787968,8790272,8794112,8806400,8849408,8851456,8855552,8880128,9183488,9187328,9191936,9199616,9310208,9314304,9322496,9371648,10944512,12718208,12720128,12726272,12781568,12783616,12812288,12853504,12857344,12869632,12980224,12984320,13041664,13377536,13385728,13500416,14747648,14778368,14815232,14876672,14950400,15007744,15073280,15466496,15761408,15794176,15859712,15990784,17318416,17318656,17326336,17326592,17330176,17572096,17575936,17580544,17588224,17698816,17702912,17711104,17760256,21889024,25436416,25440256,25452544,25563136,25567232,25624576,25707008,25714688,25960448,25968640,26083328,29495296,29556736,29630464,29753344,29900800,30015488,30146560,31522816,31588352,31719424,31981568,32505856
};

/*
unsigned int a[416] = {
						3,5,10,12,
						7,11,19,22,25,38,50,56,73,88,146,152,176,200,292,304,
						400,448,
						15,
						23,39,46,51,71,78,99,102,113,142,198,204,226,240,275,
						305,368,547,550,561,610,624,736,785,816,1094,1100,1122,1136,1220,1248,
						1570,1584,1632,1808,2188,2244,2272,3140,3168,3264,3616,3840,4369,4400,4880,5888,
						8738,8752,8800,8976,9760,9984,11776,12560,13056,17476,17504,17600,17952,18176,19520,19968,
						25120,25344,26112,28928,34952,35008,35904,36352,50240,50688,52224,57856,61440,
						31,47,79,94,103,143,158,167,199,206,227,271,286,334,391,398,
						412,451,454,481,542,668,782,796,902,908,962,992,1063,1123,1249,1504,
						2119,2126,2147,2243,2246,2273,2498,2528,3008,3107,3169,3296,4231,4238,4252,4291,
						4294,4321,4486,4492,4546,4576,4996,5056,5344,6211,6214,6241,6338,6368,6592,7201,
						7264,8462,8476,8582,8588,8642,8672,8972,8984,9092,9152,10688,12422,12428,12482,12512,
						12676,12736,13184,14402,14432,14528,15392,16924,17164,17176,17284,17344,21376,24844,24856,24964,
						25024,25352,25472,28804,28864,29056,30784,31744,33827,33889,34016,35873,35936,39968,48128,67651,
						67654,67681,67778,67808,68032,68641,68704,71746,71776,71872,72736,79936,80896,96256,99361,99424,
						101408,105472,135302,135308,135362,135392,135556,135616,136064,137282,137312,137408,138272,143492,143552,143744,
						145472,146432,159872,161792,171008,198722,198752,198848,199712,202816,203776,210944,230432,232448,270604,270616,
						270724,270784,271112,271232,274564,274624,274816,276544,277504,286984,287104,287488,290944,292864,342016,397444,
						397504,397696,399424,400384,405632,407552,421888,460864,461824,464896,492544,541208,541448,541568,549128,549248,
						549632,553088,555008,684032,794888,795008,795392,798848,800768,811264,815104,921728,923648,929792,985088,1015808,
						1082401,1082464,1084448,1088512,1147936,1149952,1278976,1540096,2164802,2164832,2164928,2165792,2168896,2169856,2177024,2196512,
						2198528,2295872,2296832,2299904,2327552,2557952,2588672,3080192,3179552,3181568,3245056,3375104,4329604,4329664,4329856,4331584,
						4332544,4337792,4339712,4354048,4393024,4393984,4397056,4424704,4591744,4593664,4599808,4655104,4685824,5115904,5177344,5472256,
						6359104,6360064,6363136,6390784,6490112,6520832,6750208,7373824,7438336,8659208,8659328,8659712,8663168,8665088,8675584,8679424,
						8786048,8787968,8794112,8849408,8880128,9183488,9187328,9199616,9310208,9371648,10944512,12718208,12720128,12726272,12781568,12812288,
						12980224,13041664,13500416,14747648,14778368,14876672,15761408,17318416,17318656,17326336,17330176,17572096,17575936,17588224,17698816,17760256,
						21889024,25436416,25440256,25452544,25563136,25624576,25960448,26083328,29495296,29556736,29753344,31522816,32505856
					};
*/

void f( int pos, int k ) {
	int i,j,score[N] = {0},cnt[2];
	unsigned int v;
	int id[N*N] = {-1};
	for ( i = 0; i < n*n; id[i++] = n*n );
	for ( i = 0; i < n; score[i++] = 0 );
	if ( k == n ) {
		for ( j = 0; j < n; ++j )
			for ( v = b[j]; v; v &= ~L(v) ) {
				assert( id[who(L(v))] == n*n );
				id[who(L(v))] = j;
			}
		for ( i = 0; i < n*n; ++i )
			assert( id[i] < n*n );
		for ( i = 0; i < n*n; ++i )
			score[id[i]]+=(c[A][i]-c[B][i]);
		for ( i = A; i <= B; ++i ) cnt[i] = 0;
		for ( i = 0, j = 0; j < n; ++j )
			if ( score[j] > 0 ) ++cnt[A];
			else if ( score[j] < 0 ) ++cnt[B];
		if ( cnt[A]-cnt[B] > w )
			w = cnt[A]-cnt[B];
		return ;
	}
	assert( k < n );
	for ( i = pos; i < idx[n]; ++i ) {
		for ( j = 0; j < k; ++j )
			if ( b[j]&a[i] )
				goto next;
		b[k] = a[i], f(i+1,k+1);
		next: continue ;
	}
}

int main() {
	int i,j,k,t,ts;
#ifndef ONLINE_JUDGE
    freopen("input.txt","r",stdin);
#endif
	for ( k = 0; k < 20; ++k ) which[BIT(k)] = k;
	for ( scanf("%d",&ts); ts-- && 1 == scanf("%d",&n); ) {
		for ( t = A; t <= B; ++t )
			for ( i = 0; i < n; ++i )
				for ( j = 0; j < n; scanf("%d",&c[t][i*n+j]), ++j );
		if ( n == 1 ) {
			k = c[A][0]-c[B][0];
			if ( k < 0 ) k = -1;
			else if ( k > 0 ) k = 1;
			printf("%d\n",k);
			continue ;
		}
		assert( 2 <= n && n < N );
		w = -oo, f(idx[n-1],0), printf("%d\n",w);
	}
    return 0;
}


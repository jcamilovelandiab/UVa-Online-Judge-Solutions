/*
 * 11441. Encoding/Decoding
 * status: Accepted
 */
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define M 201
#define H M
#define A 6
typedef long long i64;
#define MOD 10007ULL
#define oo 0xffffffffffffffffull
typedef unsigned long long u64;

int n,m,K;

typedef struct cell{struct cell *son[A];int cnt; }cell;
typedef struct { cell *root; size_t cnt; } tree;

tree *T;
char s[1 << 21];

cell *init_cell() {
	cell *x = (cell *)malloc(sizeof *x);
	int i;
	for ( x->cnt = 0, i = 0; i < K; x->son[i++] = NULL );
	return x;
}

tree *init() {
	tree *t = (tree *)malloc(sizeof *t);
	t->root = init_cell(), t->cnt = 0;
	return t;
}

void ins( tree *t, char *s ) {
	cell **x;
	for ( x = &t->root; *s; x = &((*x)->son[*s++-'0']) ) 
		if ( !(*x)->son[*s-'0'] ) 
			(*x)->son[*s-'0'] = init_cell(), ++(*x)->cnt;
}

int F( cell *x ) {
	int i,ax = 0;
	if ( !x||!x->cnt ) return 0;
	for ( ax = K-x->cnt, i = 0; i < K; ++i )
		ax += F(x->son[i]);
	return ax;
}

u64 z[A][M],d[A][M][M];

u64 calc_z( int K, int m ) {
	int t,i,j,k,l;
	u64 ax,bx;
	if ( z[K][m] < +oo )
		return z[K][m];
	if ( m == 0 )
		return z[K][m] = 1;
	if ( m == 1 ) 
		return z[K][m] = 1;
	if ( m == K )
		return z[K][m] = 1;
	z[K][m] = 0;
	if ( m < K ) return z[K][m];
	if ( (m-1) % (K-1) )
		return z[K][m] = 0;
	if ( K == 2 ) {
		for ( i = 1; i <= m-1; ++i )
			z[K][m] += (calc_z(K,i)*calc_z(K,m-i)) % MOD, z[K][m] %= MOD;
	}
	else if ( K == 3 ) {
		for ( i = 1; i <= m-2; ++i )
			for ( j = 1; i+j <= m-1; ++j )
				z[K][m] += (((calc_z(K,i)*calc_z(K,j)) % MOD)*calc_z(K,m-i-j)) % MOD, z[K][m] %= MOD;
	}
	else if ( K == 4 ) {
		for ( i = 1; i <= m-3; ++i )
			if ( calc_z(K,i) ) 
			for ( j = 1; i+j <= m-2; ++j )
				if ( calc_z(K,j) )
				for ( ax = calc_z(K,i)*calc_z(K,j), ax %= MOD, k = 1; i+j+k <= m-1 && ax; ++k )
					z[K][m] += ((ax*((calc_z(K,k)*calc_z(K,m-i-j-k)) % MOD)) % MOD), z[K][m] %= MOD;
	}
	else {
		assert( K == 5 );
		for ( i = 1; i <= m-4; ++i )
			for ( j = 1; i+j <= m-3; ++j )
				for ( ax = calc_z(K,i)*calc_z(K,j), ax %= MOD, k = 1; i+j+k <= m-2 && ax; ++k )
					for ( bx = ax*calc_z(K,k), bx %= MOD, t = 1; i+j+k+t <= m-1 && bx; ++t )
						z[K][m] += (((bx*calc_z(K,t)) % MOD)*calc_z(K,m-i-j-k-t)) % MOD, z[K][m] %= MOD;
	}
	return z[K][m];
}

u64 W( int K, int t, int m ) {
	int s;
	if ( d[K][t][m] < +oo )
		return d[K][t][m];
	if ( t == 0 ) 
		return d[K][t][m] = (m == 0 ? 1 : 0);
	if ( t == 1 ) 
		return d[K][t][m] = calc_z(K,m);
	assert( t >= 2 );
	d[K][t][m] = 0;
	for ( s = 1; s <= m-1; ++s )
		d[K][t][m] += (calc_z(K,s)*W(K,t-1,m-s)) % MOD, d[K][t][m] %= MOD;
	return d[K][t][m];
}

int main() {
	int i,j,k,t,ts;
#ifndef ONLINE_JUDGE
	freopen("in.txt","r",stdin);
#endif
	memset(z,0xfful,sizeof(z));
#if 0
	for ( K = 2; K < A; ++K )
		for ( n = 0; n < M; ++n )
			if ( calc_z(K,n) )
				printf("z[%d][%d] = %llu;\n",K,n,calc_z(K,n));
	return 0;
#endif

z[2][0] = 1;
z[2][1] = 1;
z[2][2] = 1;
z[2][3] = 2;
z[2][4] = 5;
z[2][5] = 14;
z[2][6] = 42;
z[2][7] = 132;
z[2][8] = 429;
z[2][9] = 1430;
z[2][10] = 4862;
z[2][11] = 6789;
z[2][12] = 8751;
z[2][13] = 7872;
z[2][14] = 2382;
z[2][15] = 2571;
z[2][16] = 8069;
z[2][17] = 2939;
z[2][18] = 4105;
z[2][19] = 4590;
z[2][20] = 6976;
z[2][21] = 8756;
z[2][22] = 2615;
z[2][23] = 641;
z[2][24] = 9909;
z[2][25] = 6036;
z[2][26] = 9665;
z[2][27] = 8715;
z[2][28] = 7975;
z[2][29] = 229;
z[2][30] = 4873;
z[2][31] = 6605;
z[2][32] = 5793;
z[2][33] = 1195;
z[2][34] = 8101;
z[2][35] = 1852;
z[2][36] = 428;
z[2][37] = 8945;
z[2][38] = 5400;
z[2][39] = 1525;
z[2][40] = 8373;
z[2][41] = 6639;
z[2][42] = 4164;
z[2][43] = 1879;
z[2][44] = 3166;
z[2][45] = 2902;
z[2][46] = 3833;
z[2][47] = 6539;
z[2][48] = 1572;
z[2][49] = 173;
z[2][50] = 7476;
z[2][51] = 3124;
z[2][52] = 589;
z[2][53] = 3611;
z[2][54] = 1812;
z[2][55] = 8142;
z[2][56] = 3819;
z[2][57] = 4867;
z[2][58] = 1366;
z[2][59] = 576;
z[2][60] = 245;
z[2][61] = 1284;
z[2][62] = 7917;
z[2][63] = 893;
z[2][64] = 3801;
z[2][65] = 5308;
z[2][66] = 8923;
z[2][67] = 5320;
z[2][68] = 8449;
z[2][69] = 6521;
z[2][70] = 2366;
z[2][71] = 9405;
z[2][72] = 9317;
z[2][73] = 2780;
z[2][74] = 8190;
z[2][75] = 8088;
z[2][76] = 7486;
z[2][77] = 4928;
z[2][78] = 2398;
z[2][79] = 3203;
z[2][80] = 4316;
z[2][81] = 3231;
z[2][82] = 728;
z[2][83] = 4909;
z[2][84] = 7134;
z[2][85] = 4722;
z[2][86] = 9017;
z[2][87] = 4735;
z[2][88] = 7473;
z[2][89] = 7013;
z[2][90] = 232;
z[2][91] = 9930;
z[2][92] = 2090;
z[2][93] = 155;
z[2][94] = 3378;
z[2][95] = 3713;
z[2][96] = 8991;
z[2][97] = 6728;
z[2][98] = 9141;
z[2][99] = 5989;
z[2][100] = 9787;
z[2][101] = 2799;
z[2][102] = 1613;
z[2][103] = 3832;
z[2][104] = 8179;
z[2][105] = 7660;
z[2][106] = 6605;
z[2][107] = 7532;
z[2][108] = 5248;
z[2][109] = 1699;
z[2][110] = 7795;
z[2][111] = 5065;
z[2][112] = 8016;
z[2][113] = 4894;
z[2][114] = 6678;
z[2][115] = 8438;
z[2][116] = 534;
z[2][117] = 7497;
z[2][118] = 2978;
z[2][119] = 73;
z[2][120] = 9795;
z[2][121] = 8756;
z[2][122] = 9986;
z[2][123] = 6507;
z[2][124] = 8443;
z[2][125] = 864;
z[2][126] = 6274;
z[2][127] = 4628;
z[2][128] = 3910;
z[2][129] = 564;
z[2][130] = 5463;
z[2][131] = 60;
z[2][132] = 1147;
z[2][133] = 2580;
z[2][134] = 3334;
z[2][135] = 7406;
z[2][136] = 7223;
z[2][137] = 5786;
z[2][138] = 703;
z[2][139] = 9333;
z[2][140] = 3623;
z[2][141] = 3905;
z[2][142] = 5448;
z[2][143] = 9597;
z[2][144] = 9218;
z[2][145] = 3640;
z[2][146] = 3718;
z[2][147] = 2671;
z[2][148] = 3679;
z[2][149] = 8792;
z[2][150] = 7197;
z[2][151] = 9946;
z[2][152] = 7527;
z[2][153] = 4501;
z[2][154] = 3273;
z[2][155] = 5799;
z[2][156] = 9502;
z[2][157] = 6859;
z[2][158] = 1208;
z[2][159] = 1199;
z[2][160] = 6127;
z[2][161] = 8803;
z[2][162] = 7830;
z[2][163] = 9176;
z[2][164] = 5371;
z[2][165] = 6915;
z[2][166] = 5467;
z[2][167] = 4414;
z[2][168] = 5347;
z[2][169] = 2250;
z[2][170] = 6566;
z[2][171] = 4264;
z[2][172] = 2944;
z[2][173] = 4964;
z[2][174] = 5537;
z[2][175] = 3145;
z[2][176] = 7583;
z[2][177] = 902;
z[2][178] = 8300;
z[2][179] = 7485;
z[2][180] = 4673;
z[2][181] = 237;
z[2][182] = 4899;
z[2][183] = 4835;
z[2][184] = 1235;
z[2][185] = 7875;
z[2][186] = 2839;
z[2][187] = 7626;
z[2][188] = 4285;
z[2][189] = 961;
z[2][190] = 4235;
z[2][191] = 6538;
z[2][192] = 7810;
z[2][193] = 1391;
z[2][194] = 4283;
z[2][195] = 4376;
z[2][196] = 3687;
z[2][197] = 3054;
z[2][198] = 297;
z[2][199] = 8018;
z[2][200] = 4012;
z[3][0] = 1;
z[3][1] = 1;
z[3][3] = 1;
z[3][5] = 3;
z[3][7] = 12;
z[3][9] = 55;
z[3][11] = 273;
z[3][13] = 1428;
z[3][15] = 7752;
z[3][17] = 3235;
z[3][19] = 6507;
z[3][21] = 9721;
z[3][23] = 8760;
z[3][25] = 2087;
z[3][27] = 138;
z[3][29] = 1477;
z[3][31] = 3785;
z[3][33] = 8294;
z[3][35] = 604;
z[3][37] = 3659;
z[3][39] = 2232;
z[3][41] = 3379;
z[3][43] = 4838;
z[3][45] = 2899;
z[3][47] = 7987;
z[3][49] = 9353;
z[3][51] = 5780;
z[3][53] = 2136;
z[3][55] = 8784;
z[3][57] = 1187;
z[3][59] = 3045;
z[3][61] = 9869;
z[3][63] = 6860;
z[3][65] = 782;
z[3][67] = 1961;
z[3][69] = 2452;
z[3][71] = 7547;
z[3][73] = 4774;
z[3][75] = 3462;
z[3][77] = 3884;
z[3][79] = 1528;
z[3][81] = 6746;
z[3][83] = 1271;
z[3][85] = 9623;
z[3][87] = 5867;
z[3][89] = 1318;
z[3][91] = 6962;
z[3][93] = 9272;
z[3][95] = 148;
z[3][97] = 375;
z[3][99] = 8860;
z[3][101] = 4650;
z[3][103] = 8576;
z[3][105] = 5434;
z[3][107] = 1645;
z[3][109] = 3536;
z[3][111] = 8015;
z[3][113] = 7759;
z[3][115] = 9059;
z[3][117] = 1250;
z[3][119] = 1840;
z[3][121] = 7895;
z[3][123] = 9898;
z[3][125] = 2794;
z[3][127] = 7455;
z[3][129] = 1355;
z[3][131] = 5488;
z[3][133] = 9110;
z[3][135] = 3738;
z[3][137] = 8226;
z[3][139] = 6323;
z[3][141] = 1521;
z[3][143] = 32;
z[3][145] = 2512;
z[3][147] = 5977;
z[3][149] = 3975;
z[3][151] = 4032;
z[3][153] = 8993;
z[3][155] = 314;
z[3][157] = 9007;
z[3][159] = 7722;
z[3][161] = 1478;
z[3][163] = 4518;
z[3][165] = 8043;
z[3][167] = 1923;
z[3][169] = 7770;
z[3][171] = 6451;
z[3][173] = 6790;
z[3][175] = 4330;
z[3][177] = 6780;
z[3][179] = 6166;
z[3][181] = 4151;
z[3][183] = 7635;
z[3][185] = 9789;
z[3][187] = 7765;
z[3][189] = 7628;
z[3][191] = 5904;
z[3][193] = 3172;
z[3][195] = 7258;
z[3][197] = 8033;
z[3][199] = 1898;
z[4][0] = 1;
z[4][1] = 1;
z[4][4] = 1;
z[4][7] = 4;
z[4][10] = 22;
z[4][13] = 140;
z[4][16] = 969;
z[4][19] = 7084;
z[4][22] = 3785;
z[4][25] = 438;
z[4][28] = 9915;
z[4][31] = 4764;
z[4][34] = 1011;
z[4][37] = 6237;
z[4][40] = 4029;
z[4][43] = 7069;
z[4][46] = 4289;
z[4][49] = 7033;
z[4][52] = 2351;
z[4][55] = 8556;
z[4][58] = 9898;
z[4][61] = 1317;
z[4][64] = 2184;
z[4][67] = 3606;
z[4][70] = 2451;
z[4][73] = 4075;
z[4][76] = 8254;
z[4][79] = 770;
z[4][82] = 4277;
z[4][85] = 4960;
z[4][88] = 1941;
z[4][91] = 274;
z[4][94] = 671;
z[4][97] = 168;
z[4][100] = 326;
z[4][103] = 3932;
z[4][106] = 5279;
z[4][109] = 9553;
z[4][112] = 3428;
z[4][115] = 7601;
z[4][118] = 4151;
z[4][121] = 3496;
z[4][124] = 1658;
z[4][127] = 3820;
z[4][130] = 6783;
z[4][133] = 9202;
z[4][136] = 3542;
z[4][139] = 9480;
z[4][142] = 8581;
z[4][145] = 5975;
z[4][148] = 8745;
z[4][151] = 94;
z[4][154] = 9987;
z[4][157] = 444;
z[4][160] = 2996;
z[4][163] = 4407;
z[4][166] = 1626;
z[4][169] = 1071;
z[4][172] = 9253;
z[4][175] = 2509;
z[4][178] = 3982;
z[4][181] = 2781;
z[4][184] = 5891;
z[4][187] = 2913;
z[4][190] = 18;
z[4][193] = 4876;
z[4][196] = 4210;
z[4][199] = 2338;
z[5][0] = 1;
z[5][1] = 1;
z[5][5] = 1;
z[5][9] = 5;
z[5][13] = 35;
z[5][17] = 285;
z[5][21] = 2530;
z[5][25] = 3737;
z[5][29] = 1719;
z[5][33] = 8821;
z[5][37] = 3604;
z[5][41] = 8118;
z[5][45] = 8160;
z[5][49] = 6923;
z[5][53] = 5372;
z[5][57] = 6275;
z[5][61] = 1314;
z[5][65] = 3161;
z[5][69] = 1743;
z[5][73] = 3326;
z[5][77] = 9761;
z[5][81] = 7630;
z[5][85] = 5471;
z[5][89] = 3567;
z[5][93] = 6200;
z[5][97] = 3289;
z[5][101] = 7483;
z[5][105] = 776;
z[5][109] = 9144;
z[5][113] = 1790;
z[5][117] = 7529;
z[5][121] = 8412;
z[5][125] = 3715;
z[5][129] = 7554;
z[5][133] = 4676;
z[5][137] = 7804;
z[5][141] = 7224;
z[5][145] = 8240;
z[5][149] = 2803;
z[5][153] = 220;
z[5][157] = 53;
z[5][161] = 1783;
z[5][165] = 4085;
z[5][169] = 884;
z[5][173] = 4902;
z[5][177] = 4063;
z[5][181] = 2655;
z[5][185] = 1096;
z[5][189] = 2572;
z[5][193] = 8565;
z[5][197] = 3123;

	for ( K = 2; K <= 5; ++K )
		if ( !(z[K][m]<+oo) )
			z[K][m] = 0;
	memset(d,0xfful,sizeof(d));
	for ( scanf("%d",&ts); ts--; ) {
		scanf("%d %d %d",&n,&m,&K);
		for ( T = init(), i = 0; i < n; scanf("%s",s), ins(T,s), ++i );
		t = F(T->root);
		if ( !n ) printf("%llu\n",calc_z(K,m) % MOD);
		else printf("%llu\n",W(K,t,m) % MOD);
	}
	return 0;
}

